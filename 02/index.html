<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>02</title>
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../css/reveal.css">
  <link rel="stylesheet" href="../css/theme/yandex.css" id="theme">
  <link rel="stylesheet" href="../lib/css/zenburn.css">
  <link rel="stylesheet" href="../css/user.css">
  <link rel="icon" href="../icons/favicon.png">
  <style>

  </style>
</head>
<body class="yandex nodejs">
<div class="reveal">
  <div class="slides">

    <section class="large">
      <h2>Node.js</h2>
      <p class="author">
        <small>Лекция 02</small>
      </p>
    </section>

    <section>
      <h3 class="magenta">Настройка окружения + npm</h3>
    </section>

    <section>
      <h3 class="yellow">Цели</h3>
      <ul>
        <li class="left fragment">установка node.js</li>
        <li class="left fragment">package.json</li>
        <li class="left fragment">использование npm</li>
      </ul>
    </section>

    <section>
      <h3>Версионирование</h3>
      <p class="left fragment">Две ветки</p>
      <p class="left fragment"><span class="green">8.x.x</span> - Long Term Support</p>
      <p class="left fragment"><span class="magenta">10.x.x</span> - Current</p>
    </section>

    <section>
      <h3>Установка</h3>
      <ul>
        <li class="fragment"><a href="https://nodejs.org/en/">nodejs.org</a></li>
        <li class="fragment">node --version<br>npm --version</li>
      </ul>
    </section>

    <section>
      <h2>Hello World!</h2>
    </section>

    <section>
      <p class="left">
        Создаём index.js

      <pre class="javascript"><code>
const http = require('http');

const server = http.createServer((req, res) => {
    res.end('Hello world!');
});

server.listen(2000, '127.0.0.1', () => {
    console.log('Running');
});
            </code></pre>
      </p>
    </section>

    <section>
      <p class="left ">Запускаем через консоль</p>
      <pre class="javascript"><code>
node index.js
        </code></pre>
    </section>

    <section>
      <p class="left ">Открываем в браузере</p>
      <pre class="javascript"><code>
http://127.0.0.1:2000/
        </code></pre>
    </section>

    <section>
      <h2>Brave New World</h2>
      <h3>with Node.js</h3>
    </section>

    <section>
      <h3><span class="red">S</span>emver</h3>
      <h4>Семантическое версионирование</h4>
    </section>

    <section>
      <h4>Semver</h4>

      <ul>
        <li class="left fragment"><a href="http://semver.org/lang/ru/">semver.org</a></li>
        <li class="left fragment">Набор правил</li>
        <li class="left fragment">Об изменениях сообщается через версию MAJOR.MINOR.PATCH / X.Y.Z</li>
      </ul>
    </section>

    <section>
      <h4>Semver - Правила</h4>

      <ul>
        <li class="left fragment">Объявить публичный API (код или документация)</li>
        <li class="left fragment">X, Y, Z - целые неотрицательные числа</li>
        <li class="left fragment">Нельзя изменять уже опубликованные версии</li>
        <li class="left fragment">Любые изменения - новая версия</li>
      </ul>
    </section>

    <section>
      <h4>Semver - MAJOR</h4>

      <ul>
        <li class="left fragment">cделаны обратно несовместимые изменения API</li>
        <li class="left fragment">0 - начальная разработка / все может измениться</li>
      </ul>
    </section>

    <section>
      <h4>Semver - MAJOR</h4>

      <ul>
        <li class="left fragment">ДОЛЖНА быть увеличена, если в публичном API представлены обратно несовместимые изменения</li>
        <li class="left fragment">МОЖЕТ включать изменения, характерные для уровня минорных версий и патчей</li>
        <li class="left fragment">Когда увеличивается мажорная версия, минорная и патч-версия ДОЛЖНЫ быть обнулены</li>
      </ul>
    </section>



    <section>
      <h4>Semver - MINOR</h4>

      <ul>
        <li class="left fragment">добавляете новый и изменяете старый функционал, не нарушая обратной совместимости</li>
        <li class="left fragment">ДОЛЖНА быть увеличена, если в публичном API представлен новый обратно совместимый функционал</li>
        <li class="left fragment">ДОЛЖНА быть увеличена, если какой-либо функционал публичного API помечен как устаревший</li>
      </ul>
    </section>

    <section>
      <h4>Semver - MINOR</h4>

      <ul>
        <li class="left fragment">МОЖЕТ быть увеличена в случае реализации нового функционала или существенного усовершенствования в приватном коде</li>
        <li class="left fragment">Патч-версия ДОЛЖНА быть обнулена, когда увеличивается минорная версия</li>
      </ul>
    </section>

    <section>
      <h4>Semver - PATCH</h4>

      <ul>
        <li class="left fragment">делаете обратно совместимые исправления</li>
        <li class="left fragment">ДОЛЖНА быть увеличена только если содержит обратно совместимые баг-фиксы</li>
      </ul>
    </section>

    <section>
      <h3><span class="red">n</span>pm</h3>
      <h4>Node package manager</h4>
    </section>

    <section>
      <h4>npm</h4>

      <ul>
        <li class="left fragment">850+ тыс. пакетов</li>
        <li class="left fragment">8+ млрд. установок в день</li>
        <li class="left fragment"><a href="https://docs.npmjs.com">docs.npmjs.com</a></li>
        <li class="left fragment"><a href="https://github.com/npm/npm">github.com/npm/npm</a></li>
      </ul>
    </section>

    <section>
      <h4>npm - package</h4>

      <ul>
        <li class="left fragment">a) папка с программой и package.json</li>
        <li class="left fragment">b) gzip архив (a)</li>
        <li class="left fragment">c) ссылка (b)</li>
        <li class="left fragment">d) name@version в реестре имеющий (c)</li>
        <li class="left fragment">e) name@tag указывающий на (d)</li>
        <li class="left fragment">f) name@latest указывающий на (d)</li>
        <li class="left fragment">g) ссылка на git-репозиторий с (a)</li>
      </ul>
    </section>

    <section>
      <h4>npm - install</h4>

      <pre class="javascript"><code>
// локальная установка
> npm install package_name

// глобальная
> npm install -g package_name

// сокращение
> npm i package_name
    </code></pre>
    </section>

    <section>
      <h4>npm - package.json</h4>

      <pre class="javascript"><code>
{
  "name": "my-awesome-package",
  "version": "1.0.0"
}
    </code></pre>
    </section>

    <section>
      <h4>npm - package.json</h4>

      <pre class="javascript"><code>
// lowercase
// без пробелов
// одно слово
// можно - и _
"name"

// X.Y.Z
"version"
    </code></pre>
    </section>

    <section>
      <h4>npm - package.json</h4>

      <pre class="javascript"><code>
description
keywords
homepage
bugs: { url, email }
license
author | contributors: { name, email, url }
private
    </code></pre>
    </section>

    <section>
      <h4>npm - package.json</h4>

      <pre class="javascript"><code>
// создание
// name, version, main, scripts, keywords
// author, license, repository
npm init

> npm set init.author.email "wombat@npmjs.com"
> npm set init.author.name "ag_dubs"
> npm set init.license "MIT"
    </code></pre>
    </section>

    <section>
      <h4>npm - package.json</h4>

      <pre class="javascript"><code>
// ~/.npm-init.js
module.exports = {
  customField: 'Custom Field',
  otherCustomField: 'This field is really cool'
}

// or
module.exports
  = prompt("what's your favorite ice cream?",
    "I LIKE THEM ALL");
    </code></pre>
    </section>

    <section>
      <h4>npm - dependencies</h4>

      <pre class="javascript"><code>
{
  "dependencies": {
    "my_dep": "^1.0.0"
  },
  "devDependencies": {
    "my_test_framework": "^3.1.0"
  },
  "optionalDependencies": {
    "my_optional_util": "^4.2.4"
  },
  "peerDependencies": {
    "react": "^16.0.1"
  },
}
    </code></pre>
    </section>

    <section>
      <h4>npm - deps</h4>

      <pre class="javascript"><code>
> npm install package_name --save

> npm install package_name --save-dev

> npm install

> npm install --production
    </code></pre>
    </section>

    <section>
      <h4>npm - deps</h4>

      <pre class="javascript"><code>
> npm update

> npm update package

> npm update -g
    </code></pre>
    </section>

    <section>
      <h4>npm - version</h4>

      <pre class="javascript"><code>
> npm view bluebird version

> npm version 1.0.2

> npm version [major | minor | patch]
    </code></pre>
    </section>

    <section>
      <h4>npm - version</h4>

      <pre class="javascript"><code>
"bluebird": "3.4.7"
    </code></pre>
    </section>

    <section>
      <h4>npm - version</h4>

      <pre class="javascript"><code>
// все что выше в пределах major
"bluebird": "^3.4.5"

+:
3.4.5
3.4.6
3.4.7

-:
4.0.0
    </code></pre>
    </section>

    <section>
      <h4>npm - version</h4>

      <pre class="javascript"><code>
// все что выше в пределах minor
"bluebird": "~3.3.1"

+:
3.3.1
3.3.2
3.3.3

-:
3.4.0
    </code></pre>
    </section>

    <section>
      <h4>npm - package-lock.json</h4>

      <pre class="javascript "><code>
# генерируется автоматически
# приватный, хранится в VCS
# единное дерево зависимостей
# история дерева зависимостей
    </code></pre>
    </section>

    <section>
      <h4>Yarn</h4>

      <ul>
        <li class="left fragment">Ultra Fast / кэш + паралельность + offline-mod</li>
        <li class="left fragment">Mega Secure / контрольные суммы пакетов</li>
        <li class="left fragment">Super Reliable / lock-файлы для версий</li>
        <li class="left fragment"><a href="https://yarnpkg.com/">yarnpkg.com</a></li>
      </ul>
    </section>

    <section>
      <h4>Yarn</h4>

      <img src="images/npm-vs-yarn-perf.png">
    </section>

    <section>
      <h4>Yarn</h4>

      <pre class="javascript fragment"><code>
> yarn init
    </code></pre>

      <pre class="javascript fragment"><code>
> yarn add [package]
> yarn add [package]@[version]
> yarn add [package]@[tag]
    </code></pre>

      <pre class="javascript fragment"><code>
> yarn remove [package]
    </code></pre>

      <pre class="javascript fragment"><code>
> yarn install
> yarn install --force
> yarn install --production
    </code></pre>
    </section>

    <section>
      <h3>Q&A</h3>
    </section>

    <section>
      <h3 class="yellow">BONUS</h3>
      <ul>
        <li class="left fragment"><a href="https://nodejs.org/en/about/previous-releases">nodejs версии</a></li>
        <li class="left fragment"><a href="http://semver.org/lang/ru/">semver.org</a></li>
        <li class="left"><a href="https://semver.npmjs.com/">Калькулятор версий - semver.npmjs.com</a></li>
      </ul>
    </section>
  </div>
</div>

<script src="../lib/js/head.min.js"></script>
<script src="../js/reveal.js"></script>
<script>
  Reveal.initialize({
    controls: false,
    progress: true,
    slideNumber: true,
    history: true,
    center: true,
    hideAddressBar: true,
    transition: 'slide',
    dependencies: [
      {
        src: '../plugin/highlight/highlight.js',
        async: true,
        condition: function () {
          return Boolean(document.querySelector('pre code'));
        },
        callback: function () {
          hljs.initHighlightingOnLoad();
        }
      }
    ]
  });

  const body = document.getElementsByClassName('yandex')[0];
  let invert = false;

  body.onkeypress = function (event) {
    if (event.key.toLowerCase() !== 'i') return;

    if (invert) body.style = '';
    else body.style = 'filter: invert(100%)';

    invert = !invert;
  }
</script>
</body>
</html>
